package com.didi



import com.didi.hive.udf.{DateFormat, GetParm, HiveUtils, InterfaceFormat}
import org.apache.hadoop.io.Text
import org.apache.spark.{SparkConf, SparkContext}
import org.apache.spark.sql.{DataFrame, Dataset, SparkSession}



object LogETL extends Serializable {
  val getParm = new GetParm

  /**
    * 解析用户行为内容
    * @param url
    * @return
    */
  def parse_info(url:String):String = {
    val interfacetype: String = url.split("\\?")(0)
    interfacetype match {
        case "/MobileInternet/index/mileageUpload"|"""/MobileInternet/index/mileageUpload\""" => "无详细内容"
        case "/MobileInternet/index/uploadLocus"|"""/MobileInternet/index/uploadLocus\""" => "无详细内容"
//"GET /MobileInternet/index/uploadData?activate=1&appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E6%B7%B1%E5%9C%B3%E5%B8%82&code=&id=0&imei=45CCDA79-2EFC-4F66-A821-D8FA74DE7A91&kernel_version=&latitude=22.56091959635417&logintoken=dea0fffa93b45168df95788ec0e6235f&longitude=114.0987581380208&mac=020000000000&miudrive=1.0.0.0&miudriveserve=&mobile_version=10.3&model=iPhone%206S%20Plus&number=&platform=IOS&serialno=3004ADD6C3F944AF&userid=2965034&version=1.0.1.0 HTTP/1.1" 200 156 "-" "MDriving/1.0.10829 (iPhone; iOS 10.3.3; Scale/3.00)"
        case "/MobileInternet/index/uploadData" => "使用app："+getParm.getParamByUrl(url,"appname")
//"GET /MobileInternet/index/version?appname=MJGJ&sev=3.24.1.1&version=3.2.1.111319&userid=3182536&city=%E5%93%88%E5%B0%94%E6%BB%A8%E5%B8%82&province=%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81&area=%E6%9D%BE%E5%8C%97%E5%8C%BA&longitude=126.59065483940972&latitude=45.80972900390625&location=%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81%E5%93%88%E5%B0%94%E6%BB%A8%E5%B8%82%E6%9D%BE%E5%8C%97%E5%8C%BA%E9%9D%A0%E8%BF%91%E8%83%A1%E5%AE%B6%E8%A1%97&appid=1&logintoken=a475f4bbd7e63bf5b453b69600099d5b&platform=android&mobile_model=JSN-AL00&mobile_version=9&imei=863845041313317&mobile_mac=30%3A45%3A96%3A45%3A2F%3A81&resolution=1080x2255&company=%E4%B8%AD%E5%9B%BD%E7%94%B5%E4%BF%A1&network=4G&didisign=90675249135E6F4C0F40F869C30F8870 HTTP/1.1" 200 82 "-" "okhttp-okgo/jeasonlzy"
        case "/MobileInternet/index/version" => "版本更新："+getParm.getParamByUrl(url,"version")
//"GET /MobileInternet/Creategroup/check?userid=3512495&appid=1&logintoken=75730df9be222b232e8ef7958d4a5d44&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&platform=ios&appname=MJ&version=3.1.0.042610&didisign=5AFD4C0A9673BDB00702601F0319F824 HTTP/1.1" 200 130 "-" "okhttp/3.3.0"
        case "/MobileInternet/Creategroup/check" => "检查是否在群组"
//"GET /MobileInternet/Creategroup/create?userid=2593902&city=%E6%BC%B3%E5%B7%9E%E5%B8%82&appid=1&logintoken=69307cc41238a3ae363484986b87a867&city=%E6%BC%B3%E5%B7%9E%E5%B8%82&platform=android&appname=MJ&version=3.1.0.042811&didisign=1AF3E843BA7CBBE0123C286B07D963DA HTTP/1.1" 200 144 "-" "okhttp/3.3.0"
        case "/MobileInternet/Creategroup/create" => "建群"
//"GET /MobileInternet/Creategroup/joi?nuserid=3510329&key=2580&city=%E4%B8%B4%E6%B2%82%E5%B8%82&province=%E5%B1%B1%E4%B8%9C%E7%9C%81&area=%E8%8E%92%E5%8D%97%E5%8E%BF&longitude=119.09035&latitude=35.224427&location=%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%B4%E6%B2%82%E5%B8%82%E8%8E%92%E5%8D%97%E5%8E%BF%E5%A4%A7%E5%B1%B1%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%B1%B1%E4%B8%9C%E4%B8%B4%E6%B8%AF%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&appid=1&logintoken=8a5538e0b29909ea90f460a2a7c97d35&platform=android&appname=MJ&version=3.1.0.042811&mobile_model=MI%208&mobile_version=9&imei=863976042770195&mobile_mac=94%3A87%3AE0%3A0C%3A98%3A91&resolution=1080x2029&company=%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8&network=4G&didisign=A842B726D3E60AAA8DEE1362B069A0C7 HTTP/1.1" 200 94 "-" "okhttp-okgo/jeasonlzy"
        case "/MobileInternet/Creategroup/join/"|"/MobileInternet/Creategroup/join" => "加入群组"
//"GET /MobileInternet/Creategroup/signout?group_id=38856&userid=3510329&city=%E4%B8%B4%E6%B2%82%E5%B8%82&province=%E5%B1%B1%E4%B8%9C%E7%9C%81&area=%E8%8E%92%E5%8D%97%E5%8E%BF&longitude=119.09035&latitude=35.224427&location=%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%B4%E6%B2%82%E5%B8%82%E8%8E%92%E5%8D%97%E5%8E%BF%E5%A4%A7%E5%B1%B1%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%B1%B1%E4%B8%9C%E4%B8%B4%E6%B8%AF%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&appid=1&logintoken=8a5538e0b29909ea90f460a2a7c97d35&platform=android&appname=MJ&version=3.1.0.042811&mobile_model=MI%208&mobile_version=9&imei=863976042770195&mobile_mac=94%3A87%3AE0%3A0C%3A98%3A91&resolution=1080x2029&company=%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8&network=4G&didisign=2AC6FDB9754FD5EDF47D4D863F902FDA HTTP/1.1" 200 100 "-" "okhttp-okgo/jeasonlzy"
        case "/MobileInternet/Creategroup/signout/"|"/MobileInternet/Creategroup/signout" => "退出群组"
//"GET /MobileInternet/index/getBanner/?callback=jQuery211047555249363816987_1558830202691&tid=32&userid=3493896&logintoken=c03bdf57d020605f93523612719e343b&appname=&appid=1&platform=web&version=1.0&apptype=1&logintoken_ddshop=&wxappid=&_=1558830202692 HTTP/1.1" 200 1499 "https://api22.didi365.com/web/miudrive/mall/index.html?new=1&userid=3493896&nickname=%E5%96%B5%E5%8F%8B3493896&logintoken=c03bdf57d020605f93523612719e343b&mobile=3493896&time=1558830201460" "Mozilla/5.0 (Linux; Android 8.1.0; V1813A Build/O11019; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 MQQBrowser/6.2 TBS/044704 Mobile Safari/537.36mj/mj"
        case "//MobileInternet/index/getBanner"|"/MobileInternet/index/getBanner"|"/MobileInternet/index/getBanner/" => "无详细内容"
//"GET /MobileInternet/index/msxiaoice?type=1&userid=2081939&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=6293ea18e54e247be022765e94bb8c49&platform=android&appname=MJ&version=3.0.0.25&serialno=VKUKOBTCLVLZVWON&kernel_version=3.0.4.1&miudriveserver=&miudrive=3.0.0.25&car_model=&machine_brand=&car_version=&car_mac=00:08:22:3A:15:FC&imei=865651034118970&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=DD6CE90839D3705DE279662C9441208E HTTP/1.1" 200 181 "-" "Mozilla/5.0 (Linux; U; Android 6.0; zh-cn; evb3561sv_w_65_m0 Build/MRA58K) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Mobile Safari/537.36"
        case "/MobileInternet/index/msxiaoice" => "无详细内容"
//"GET /MobileInternet/index/sn?id=78380&second=0&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=c4d2712c61e0b043814e40c66470a78c&platform=android&appname=MJPRO&version=1.0.0.122700&userid=3376384&serialno=00GPSNMRO1TN&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.0.122700&car_model=&machine_brand=&car_version=&car_mac=E0:3B:C6:BA:96:27&imei&resolution=1024x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name&sn=00GPSNMRO1TN&didisign=374A6DF4439DF6153C6723F3C96BA120 HTTP/1.1" 200 83 "-" "Mozilla/5.0 (Linux; U; Android 7.0; zh-cn; molly Build/NRD91N) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"
        case "/MobileInternet/index/sn" => "无详细内容"
//"GET /MobileInternet/Music/collectionList?type=1&userid=2607877&page=0&city=%E4%B8%B9%E4%B8%9C%E5%B8%82&province=%E8%BE%BD%E5%AE%81%E7%9C%81&area=%E6%8C%AF%E5%AE%89%E5%8C%BA&longitude=124.31465277777778&latitude=40.12568033854166&location=%E8%BE%BD%E5%AE%81%E7%9C%81%E4%B8%B9%E4%B8%9C%E5%B8%82%E6%8C%AF%E5%AE%89%E5%8C%BA%E5%85%B4%E5%9B%AD%E8%A1%97%E9%9D%A0%E8%BF%91%E9%9E%A0%E5%AE%B6%E5%A0%A1&appid=3&logintoken=95ff76ac87e595c4f82ec8730b3645e2&platform=android&appname=MJ&version=3.2.1.111319&serialno=344078868600041b0611&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.2.1.111319&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:1A:41:7F&imei=867860442767487&resolution=1024x600&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=03341A9F5F216036E577BE3F6F6711D6 HTTP/1.1" 200 83 "-" "Mozilla/5.0
        case "/MobileInternet/Music/collectionList" => if(getParm.getParamByUrl(url,"type")=="""0"""){"收藏歌曲"}else{"收藏歌单"}
//"GET /MobileInternet/Music/doMusicCollect?track_artist=%E6%B8%A9%E5%B2%9A&track_id=95742&track_file_path=http%3A%2F%2Fdl.stream.qqmusic.qq.com%2FC400003oF0Pc0ahSx4.m4a%3Fvkey%3DA412336F6737A73F1F866CA8CFC0A6B9947D35B739CC4C6CEC2A1580B3769DE121BD36FFD14596B6CE5ACC2DF7522F61BDC25189B18BCD6D%26guid%3D7982961828%26uin%3D0%26fromtag%3D66&track_name=%E5%B1%8B%E9%A1%B6&userid=3408427&city=%E5%90%88%E8%82%A5%E5%B8%82&province=%E5%AE%89%E5%BE%BD%E7%9C%81&area=%E9%95%BF%E4%B8%B0%E5%8E%BF&longitude=117.142841796875&latitude=32.12981553819444&location=%E5%AE%89%E5%BE%BD%E7%9C%81%E5%90%88%E8%82%A5%E5%B8%82%E9%95%BF%E4%B8%B0%E5%8E%BF%E9%9D%A0%E8%BF%91%E9%99%B6%E6%A5%BC%E5%B0%8F%E5%AD%A6&appid=3&logintoken=ad2353db2dbfb202dbe1607d355056ac&platform=android&appname=MJ&version=3.0.2.072418&serialno=0123456789ABCDEF&kernel_version=3.34.1.1&miudriveserver=&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=C0:81:35:11:23:B6&imei&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=4F6C8FF3A246911ABBA4208FF87F7769
        case "/MobileInternet/Music/doMusicCollect" => getParm.getParamByUrl(url,"track_name")
//"GET /MobileInternet/Music/menuMusicList?userid=3509180&id=541&page=0&city=%E8%8B%8F%E5%B7%9E%E5%B8%82&province=%E6%B1%9F%E8%8B%8F%E7%9C%81&area=%E6%98%86%E5%B1%B1%E5%B8%82&longitude=120.92695258246528&latitude=31.36940673828125&location=%E6%B1%9F%E8%8B%8F%E7%9C%81%E8%8B%8F%E5%B7%9E%E5%B8%82%E6%98%86%E5%B1%B1%E5%B8%82%E6%9C%9D%E9%98%B3%E8%A5%BF%E8%B7%AF2168%E9%9D%A0%E8%BF%91%E5%A4%A7%E8%99%9E%E6%B2%B3%E5%8D%97%E6%A1%A5&appid=3&logintoken=9fa7d447e5322b933149c579c45e60f3&platform=android&appname=MJ&version=3.2.1.111319&serialno=1440788701201c0f0851&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.2.1.111319&car_model=&machine_brand=&car_version=&car_mac=02:00:00:00:00:02&imei=867860434473589&resolution=1024x600&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=80C28A0A0E25EB885E7970ECEB3DCE5E HTTP/1.1" 200 33286
        case "/MobileInternet/Music/menuMusicList" => "歌单id："+getParm.getParamByUrl(url,"id")
//"GET /MobileInternet/Music/menuRecList?userid=3507148&page=1&city=%E6%B3%B0%E5%B7%9E%E5%B8%82&province=%E6%B1%9F%E8%8B%8F%E7%9C%81&area=%E5%A7%9C%E5%A0%B0%E5%8C%BA&longitude=120.11857077351644&latitude=32.50629186322736&location=%E6%B1%9F%E8%8B%8F%E7%9C%81%E6%B3%B0%E5%B7%9E%E5%B8%82%E5%A7%9C%E5%A0%B0%E5%8C%BA%E5%8D%97%E4%BA%AC%E8%B7%AF5%E9%9D%A0%E8%BF%91%E6%B1%9F%E8%8B%8F%E5%A4%AA%E5%B9%B3%E6%B4%8B%E7%B2%BE%E9%94%BB%E7%A7%91%E6%8A%80%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E4%B8%80%E5%8E%82%E5%8C%BA&appid=3&logintoken=9f1284b48e24cc0bb203cc9fa06bc378&platform=android&appname=MJ&version=3.2.0.092817&serialno=JLB29R2ZNL&kernel_version=3.3.6.1&miudriveserver=&miudrive=3.2.0.092817&car_model=&machine_brand=&car_version=&car_mac=A0:2C:1A:52:B8:15&imei=352345441628693&resolution=800x960&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=FEEB7946556F7C5A508822D52355FDCE HTTP/1.1" 200 3224 "-"
        case "/MobileInternet/Music/menuRecList" => "歌单列表第："+getParm.getParamByUrl(url,"page")+"页"
//"GET /MobileInternet/Radio/collect_radio?album_id=295157&id=11611174&category=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B3&duration=954&title=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B302%E4%BC%9A%E9%9D%A2+&img=http%3A%2F%2Fpic.qingting.fm%2Fchannel%2F2019%2F04%2F18%2F29595f987878b52b8274af058d3a7758.jpg%21200&userid=2684768&radio=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B302%E4%BC%9A%E9%9D%A2+&type=0&city=%E4%B9%9D%E6%B1%9F%E5%B8%82&province=%E6%B1%9F%E8%A5%BF%E7%9C%81&area=%E6%B5%94%E9%98%B3%E5%8C%BA&longitude=116.0135267469618&latitude=29.730203721788193&location=%E6%B1%9F%E8%A5%BF%E7%9C%81%E4%B9%9D%E6%B1%9F%E5%B8%82%E6%B5%94%E9%98%B3%E5%8C%BA%E8%8A%B1%E6%9E%9C%E5%9B%AD%E5%8C%97%E8%B7%AF%E9%9D%A0%E8%BF%91%E6%9C%9D%E9%98%B3%E9%87%8C&appid=3&logintoken=8ce4706cbd3336e42e6bf98300d9a6a9&platform=android&appname=MJ&version=3.0.2.072418&serialno=8bf70c041e06489&kernel_version=&miudriveserver=2.0.7&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=00:08:22:B1:D1:FB&imei=8bf70c041e06489&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=CEF7177D3BF581D0CF51D8A4DFE0C28A
        case "/MobileInternet/Radio/collect_radio" => getParm.getParamByUrl(url,"title")
//"GET /MobileInternet/Radio/collectRadio_list?page=1&userid=0&city=%E4%BF%9D%E5%AE%9A%E5%B8%82&province=%E6%B2%B3%E5%8C%97%E7%9C%81&area=%E6%B8%85%E8%8B%91%E5%8C%BA&longitude=115.56979871961805&latitude=38.795680067274304&location=%E6%B2%B3%E5%8C%97%E7%9C%81%E4%BF%9D%E5%AE%9A%E5%B8%82%E6%B8%85%E8%8B%91%E5%8C%BA%E9%9D%A0%E8%BF%91%E8%82%A9%E9%A2%88%E4%B8%80%E7%BB%9D&appid=3&logintoken=&platform=android&appname=MJSP&version=1.0.1.061311&serialno=LVDYAULNZHVG9H4T&kernel_version=1.0.2.1&miudriveserver=&miudrive=1.0.1.061311&car_model=&machine_brand=&car_version=&car_mac=00:08:22:C8:AF:FB&imei&resolution=1024x600&company=&network=4g&car_brand=&car_models=&car_detail=&didisign=2220596EE07EC3503401DEC865241CE5 HTTP/1.1" 200 76 "-"
        case "/MobileInternet/Radio/collectRadio_list" => "查看电台热门分类第"+getParm.getParamByUrl(url,"page")+"页"
//GET /MobileInternet/Radio/is_collect?userid=1951208&channel_id=3808960&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=8f4f2c19a862bb24ad981e0f1e9f4f7e&platform=android&appname=MJ&version=3.0.2.072418&serialno=4450503705240c08038f&kernel_version=2.24.2.1&miudriveserver=2.0.9&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:F3:03:3C&imei=867864085265212&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=D9CBA5F9F93039D6CAB03E60D5EF8F7D HTTP/1.1" 200 90 "-"
        case "/MobileInternet/Radio/is_collect" => "查看看是否收藏电台："+getParm.getParamByUrl(url,"channel_id")

        //case "/MobileInternet/Service/canLink" => "导入激活sn"
//"GET /MobileInternet/service/checkCode?code=88ZI9NXDXH1Y&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=&platform=android&appname=MJPRO&version=1.0.1.052514&userid=&serialno=88ZI9NXDXH1Y&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.052514&car_model=&machine_brand=&car_version=&car_mac=6C:21:A2:71:9D:C2&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=nissan%00&sn=88ZI9NXDXH1Y&blackList=true&didisign=B17C463991AF9A4D42FC633E86D05057 HTTP/1.1" 200 963 "-" "Mozilla/5.0
        case "//MobileInternet/service/checkCode"|"/MobileInternet/service/checkCode"|"""/MobileInternet/service/checkCode\""" => "无详细内容"
//"GET /MobileInternet/service/getCode?device_name=%E5%96%B5%E9%A9%BE%E7%9B%92%E5%AD%90&device_id=f07392b3-a869-4d19-a4f8-93ac51c63641&firmware_version=MIUOS1.0_008_121_2019040216&code=12AKEW426MEW&mac=CC%3A4B%3A73%3A7A%3A76%3AF2&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=&platform=android&appname=MJPRO&version=1.0.1.040214&userid=&serialno=12AKEW426MEW&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.040214&car_model=&machine_brand=&car_version=&car_mac=CC:4B:73:7A:76:F2&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=volkswagen%00&sn=12AKEW426MEW&didisign=A44D7AD7124BCFD23B208435D4A7EC09 HTTP/1.1"
        case "/MobileInternet/service/getCode" => "无详细内容"

        //case "/MobileInternet/service/getIcon" => "获取图标或内容"

        //case "/MobileInternet/user/delCollectRecord" => parms(0).split("\\=")(1)+" "+"删除收藏记录"+parms(1).split("\\=")(1)
//"GET /MobileInternet/user/getPreset?userid=3508386&city=%E9%93%B6%E5%B7%9D%E5%B8%82&province=%E5%AE%81%E5%A4%8F%E5%9B%9E%E6%97%8F%E8%87%AA%E6%B2%BB%E5%8C%BA&area=%E6%B0%B8%E5%AE%81%E5%8E%BF&longitude=106.273811&latitude=38.380916&location=%E5%AE%81%E5%A4%8F%E5%9B%9E%E6%97%8F%E8%87%AA%E6%B2%BB%E5%8C%BA%E9%93%B6%E5%B7%9D%E5%B8%82%E6%B0%B8%E5%AE%81%E5%8E%BF%E6%9C%9B%E9%80%9A%E8%B7%AF2&appid=3&logintoken=e0b914f9e46ccb7aa2c9ad3f1db30b5c&platform=android&appname=MJ&version=3.0.0.070317&serialno=644078928404442006d1&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.0.0.070317&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:AF:37:2A&imei=867862936240426&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=4D5B4920C71A2A43DF026DC87D732B
        case "/MobileInternet/user/getPreset" => getParm.getParamByUrl(url,"location")
//"GET /MobileInternet/user/getSearchList?appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&imei=24BA9D39-C4CB-4D0E-A35D-FA6C9BC62136&logintoken=d4373831b9c626f8a54e1f42c3f56509&page=1&platform=ios&userid=3508537&version=1.0.1.0 HTTP/1.1" 200 83 "-" "
        case "/MobileInternet/user/getSearchList" => "导航搜索列表:第"+getParm.getParamByUrl(url,"page")+"页"
//"GET /MobileInternet/user/getUsers?userid=1916922&city=%E5%B2%B3%E9%98%B3%E5%B8%82&province=%E6%B9%96%E5%8D%97%E7%9C%81&area=%E5%B2%B3%E9%98%B3%E6%A5%BC%E5%8C%BA&longitude=113.16867377387153&latitude=29.395735948350694&location=%E6%B9%96%E5%8D%97%E7%9C%81%E5%B2%B3%E9%98%B3%E5%B8%82%E5%B2%B3%E9%98%B3%E6%A5%BC%E5%8C%BA%E5%86%B7%E6%B0%B4%E9%93%BA%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%86%B7%E6%B0%B4%E9%93%BA%E8%A1%97%E9%81%93%E7%BA%A2%E6%97%A5%E7%A4%BE%E5%8C%BA%E5%8D%AB%E7%94%9F%E6%9C%8D%E5%8A%A1%E7%AB%99&appid=3&logintoken=156040caa5373e4fab314db52b4595d2&platform=android&appname=MJSP&version=1.0.0.050817&serialno=0123456789ABCDEF&kernel_version=1.0.2.1&miudriveserver=&miudrive=1.0.0.050817&car_model=&machine_brand=&car_version=&car_mac=00:08:22:06:AE:FB&imei&resolution=1024x600&company=&network=4g&car_brand=&car_models=&car_detail=&didisign=1FBAC0E65C229A6B0BF7929529735CF4
        case "/MobileInternet/user/getUsers" => getParm.getParamByUrl(url,"location")

        //case "/MobileInternet/user/putCollectRecord" => "添加导航收藏"
//"GET /MobileInternet/user/putSearchRecord?addr=%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%95%AA%E7%A6%BA%E5%8C%BA%E7%9F%B3%E5%9F%BA%E9%95%87S5%E5%B9%BF%E6%98%8E%E9%AB%98%E9%80%9F&appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&detail=%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%95%AA%E7%A6%BA%E5%8C%BA%E7%9F%B3%E5%9F%BA%E9%95%87S5%E5%B9%BF%E6%98%8E%E9%AB%98%E9%80%9F&imei=8BB7C864-910B-449A-BD99-346E3BDC4945&latitude=22.995855&logintoken=46a8fdd6f5564eeb7792fb94aa648ab9&longitude=113.411197&platform=ios&userid=3505503&version=1.0.1.
        case "/MobileInternet/user/putSearchRecord" => getParm.getParamByUrl(url,"addr")
//"GET /MobileInternet/user/welcome?userid=3221892&city=&province=&area=&longitude=106.15597249348959&latitude=30.77332763671875&location=&appid=3&logintoken=ed20f9f1219bdb364d91b2508d398234&platform=android&appname=MJ&version=3.0.0.070317&serialno=34c078914214581401d1&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.0.0.070317&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:2E:2B:84&imei=867860778221188&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=3A203DCBC4668980B532F74EFED4F449 HTTP/1.1" 200 106 "-" "Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; t3 Build/KOT49H) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"
        case "/MobileInternet/user/welcome" => "无详细内容"

        case "/MobileInternet/Voice/order_json"  => "无详细内容"
    }

  }

  /**
    * 得到用户当前位置
    * 没有详细地址则返回当前城市
    * @param url
    * @return
    */
  def parse_location(url:String):String = {
    val interfacetype: String = url.split("\\?")(0).replace("//","/")
    interfacetype match {
        case "/MobileInternet/index/mileageUpload"|"""/MobileInternet/index/mileageUpload\""" => "无法获取位置信息"
        case "/MobileInternet/index/uploadLocus"|"""/MobileInternet/index/uploadLocus\""" => "无法获取位置信息"
      //"GET /MobileInternet/index/uploadData?activate=1&appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E6%B7%B1%E5%9C%B3%E5%B8%82&code=&id=0&imei=45CCDA79-2EFC-4F66-A821-D8FA74DE7A91&kernel_version=&latitude=22.56091959635417&logintoken=dea0fffa93b45168df95788ec0e6235f&longitude=114.0987581380208&mac=020000000000&miudrive=1.0.0.0&miudriveserve=&mobile_version=10.3&model=iPhone%206S%20Plus&number=&platform=IOS&serialno=3004ADD6C3F944AF&userid=2965034&version=1.0.1.0 HTTP/1.1" 200 156 "-" "MDriving/1.0.10829 (iPhone; iOS 10.3.3; Scale/3.00)"
      case "/MobileInternet/index/uploadData" => "上报位置："+getParm.getParamByUrl(url,"city")
      //"GET /MobileInternet/index/version?appname=MJGJ&sev=3.24.1.1&version=3.2.1.111319&userid=3182536&city=%E5%93%88%E5%B0%94%E6%BB%A8%E5%B8%82&province=%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81&area=%E6%9D%BE%E5%8C%97%E5%8C%BA&longitude=126.59065483940972&latitude=45.80972900390625&location=%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81%E5%93%88%E5%B0%94%E6%BB%A8%E5%B8%82%E6%9D%BE%E5%8C%97%E5%8C%BA%E9%9D%A0%E8%BF%91%E8%83%A1%E5%AE%B6%E8%A1%97&appid=1&logintoken=a475f4bbd7e63bf5b453b69600099d5b&platform=android&mobile_model=JSN-AL00&mobile_version=9&imei=863845041313317&mobile_mac=30%3A45%3A96%3A45%3A2F%3A81&resolution=1080x2255&company=%E4%B8%AD%E5%9B%BD%E7%94%B5%E4%BF%A1&network=4G&didisign=90675249135E6F4C0F40F869C30F8870 HTTP/1.1" 200 82 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/index/version" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/Creategroup/check?userid=3512495&appid=1&logintoken=75730df9be222b232e8ef7958d4a5d44&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&platform=ios&appname=MJ&version=3.1.0.042610&didisign=5AFD4C0A9673BDB00702601F0319F824 HTTP/1.1" 200 130 "-" "okhttp/3.3.0"
      case "/MobileInternet/Creategroup/check" => "上报位置："+getParm.getParamByUrl(url,"city")
      //"GET /MobileInternet/Creategroup/create?userid=2593902&city=%E6%BC%B3%E5%B7%9E%E5%B8%82&appid=1&logintoken=69307cc41238a3ae363484986b87a867&city=%E6%BC%B3%E5%B7%9E%E5%B8%82&platform=android&appname=MJ&version=3.1.0.042811&didisign=1AF3E843BA7CBBE0123C286B07D963DA HTTP/1.1" 200 144 "-" "okhttp/3.3.0"
      case "/MobileInternet/Creategroup/create" => "上报位置："+getParm.getParamByUrl(url,"city")
      //"GET /MobileInternet/Creategroup/join?userid=3510329&key=2580&city=%E4%B8%B4%E6%B2%82%E5%B8%82&province=%E5%B1%B1%E4%B8%9C%E7%9C%81&area=%E8%8E%92%E5%8D%97%E5%8E%BF&longitude=119.09035&latitude=35.224427&location=%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%B4%E6%B2%82%E5%B8%82%E8%8E%92%E5%8D%97%E5%8E%BF%E5%A4%A7%E5%B1%B1%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%B1%B1%E4%B8%9C%E4%B8%B4%E6%B8%AF%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&appid=1&logintoken=8a5538e0b29909ea90f460a2a7c97d35&platform=android&appname=MJ&version=3.1.0.042811&mobile_model=MI%208&mobile_version=9&imei=863976042770195&mobile_mac=94%3A87%3AE0%3A0C%3A98%3A91&resolution=1080x2029&company=%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8&network=4G&didisign=A842B726D3E60AAA8DEE1362B069A0C7 HTTP/1.1" 200 94 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/Creategroup/join/"|"/MobileInternet/Creategroup/join" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/Creategroup/signout?group_id=38856&userid=3510329&city=%E4%B8%B4%E6%B2%82%E5%B8%82&province=%E5%B1%B1%E4%B8%9C%E7%9C%81&area=%E8%8E%92%E5%8D%97%E5%8E%BF&longitude=119.09035&latitude=35.224427&location=%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%B4%E6%B2%82%E5%B8%82%E8%8E%92%E5%8D%97%E5%8E%BF%E5%A4%A7%E5%B1%B1%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%B1%B1%E4%B8%9C%E4%B8%B4%E6%B8%AF%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&appid=1&logintoken=8a5538e0b29909ea90f460a2a7c97d35&platform=android&appname=MJ&version=3.1.0.042811&mobile_model=MI%208&mobile_version=9&imei=863976042770195&mobile_mac=94%3A87%3AE0%3A0C%3A98%3A91&resolution=1080x2029&company=%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8&network=4G&didisign=2AC6FDB9754FD5EDF47D4D863F902FDA HTTP/1.1" 200 100 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/Creategroup/signout/"|"/MobileInternet/Creategroup/signout" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/index/getBanner/?callback=jQuery211047555249363816987_1558830202691&tid=32&userid=3493896&logintoken=c03bdf57d020605f93523612719e343b&appname=&appid=1&platform=web&version=1.0&apptype=1&logintoken_ddshop=&wxappid=&_=1558830202692 HTTP/1.1" 200 1499 "https://api22.didi365.com/web/miudrive/mall/index.html?new=1&userid=3493896&nickname=%E5%96%B5%E5%8F%8B3493896&logintoken=c03bdf57d020605f93523612719e343b&mobile=3493896&time=1558830201460" "Mozilla/5.0 (Linux; Android 8.1.0; V1813A Build/O11019; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 MQQBrowser/6.2 TBS/044704 Mobile Safari/537.36mj/mj"
      case "//MobileInternet/index/getBanner"|"/MobileInternet/index/getBanner"|"/MobileInternet/index/getBanner/" => "无法获取位置信息"
      //"GET /MobileInternet/index/msxiaoice?type=1&userid=2081939&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=6293ea18e54e247be022765e94bb8c49&platform=android&appname=MJ&version=3.0.0.25&serialno=VKUKOBTCLVLZVWON&kernel_version=3.0.4.1&miudriveserver=&miudrive=3.0.0.25&car_model=&machine_brand=&car_version=&car_mac=00:08:22:3A:15:FC&imei=865651034118970&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=DD6CE90839D3705DE279662C9441208E HTTP/1.1" 200 181 "-" "Mozilla/5.0 (Linux; U; Android 6.0; zh-cn; evb3561sv_w_65_m0 Build/MRA58K) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Mobile Safari/537.36"
      case "/MobileInternet/index/msxiaoice" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/index/sn?id=78380&second=0&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=c4d2712c61e0b043814e40c66470a78c&platform=android&appname=MJPRO&version=1.0.0.122700&userid=3376384&serialno=00GPSNMRO1TN&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.0.122700&car_model=&machine_brand=&car_version=&car_mac=E0:3B:C6:BA:96:27&imei&resolution=1024x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name&sn=00GPSNMRO1TN&didisign=374A6DF4439DF6153C6723F3C96BA120 HTTP/1.1" 200 83 "-" "Mozilla/5.0 (Linux; U; Android 7.0; zh-cn; molly Build/NRD91N) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"
      case "/MobileInternet/index/sn" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/Music/collectionList?type=1&userid=2607877&page=0&city=%E4%B8%B9%E4%B8%9C%E5%B8%82&province=%E8%BE%BD%E5%AE%81%E7%9C%81&area=%E6%8C%AF%E5%AE%89%E5%8C%BA&longitude=124.31465277777778&latitude=40.12568033854166&location=%E8%BE%BD%E5%AE%81%E7%9C%81%E4%B8%B9%E4%B8%9C%E5%B8%82%E6%8C%AF%E5%AE%89%E5%8C%BA%E5%85%B4%E5%9B%AD%E8%A1%97%E9%9D%A0%E8%BF%91%E9%9E%A0%E5%AE%B6%E5%A0%A1&appid=3&logintoken=95ff76ac87e595c4f82ec8730b3645e2&platform=android&appname=MJ&version=3.2.1.111319&serialno=344078868600041b0611&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.2.1.111319&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:1A:41:7F&imei=867860442767487&resolution=1024x600&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=03341A9F5F216036E577BE3F6F6711D6 HTTP/1.1" 200 83 "-" "Mozilla/5.0
      case "/MobileInternet/Music/collectionList" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/Music/doMusicCollect?track_artist=%E6%B8%A9%E5%B2%9A&track_id=95742&track_file_path=http%3A%2F%2Fdl.stream.qqmusic.qq.com%2FC400003oF0Pc0ahSx4.m4a%3Fvkey%3DA412336F6737A73F1F866CA8CFC0A6B9947D35B739CC4C6CEC2A1580B3769DE121BD36FFD14596B6CE5ACC2DF7522F61BDC25189B18BCD6D%26guid%3D7982961828%26uin%3D0%26fromtag%3D66&track_name=%E5%B1%8B%E9%A1%B6&userid=3408427&city=%E5%90%88%E8%82%A5%E5%B8%82&province=%E5%AE%89%E5%BE%BD%E7%9C%81&area=%E9%95%BF%E4%B8%B0%E5%8E%BF&longitude=117.142841796875&latitude=32.12981553819444&location=%E5%AE%89%E5%BE%BD%E7%9C%81%E5%90%88%E8%82%A5%E5%B8%82%E9%95%BF%E4%B8%B0%E5%8E%BF%E9%9D%A0%E8%BF%91%E9%99%B6%E6%A5%BC%E5%B0%8F%E5%AD%A6&appid=3&logintoken=ad2353db2dbfb202dbe1607d355056ac&platform=android&appname=MJ&version=3.0.2.072418&serialno=0123456789ABCDEF&kernel_version=3.34.1.1&miudriveserver=&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=C0:81:35:11:23:B6&imei&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=4F6C8FF3A246911ABBA4208FF87F7769
      case "/MobileInternet/Music/doMusicCollect" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/Music/menuMusicList?userid=3509180&id=541&page=0&city=%E8%8B%8F%E5%B7%9E%E5%B8%82&province=%E6%B1%9F%E8%8B%8F%E7%9C%81&area=%E6%98%86%E5%B1%B1%E5%B8%82&longitude=120.92695258246528&latitude=31.36940673828125&location=%E6%B1%9F%E8%8B%8F%E7%9C%81%E8%8B%8F%E5%B7%9E%E5%B8%82%E6%98%86%E5%B1%B1%E5%B8%82%E6%9C%9D%E9%98%B3%E8%A5%BF%E8%B7%AF2168%E9%9D%A0%E8%BF%91%E5%A4%A7%E8%99%9E%E6%B2%B3%E5%8D%97%E6%A1%A5&appid=3&logintoken=9fa7d447e5322b933149c579c45e60f3&platform=android&appname=MJ&version=3.2.1.111319&serialno=1440788701201c0f0851&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.2.1.111319&car_model=&machine_brand=&car_version=&car_mac=02:00:00:00:00:02&imei=867860434473589&resolution=1024x600&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=80C28A0A0E25EB885E7970ECEB3DCE5E HTTP/1.1" 200 33286
      case "/MobileInternet/Music/menuMusicList" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/Music/menuRecList?userid=3507148&page=1&city=%E6%B3%B0%E5%B7%9E%E5%B8%82&province=%E6%B1%9F%E8%8B%8F%E7%9C%81&area=%E5%A7%9C%E5%A0%B0%E5%8C%BA&longitude=120.11857077351644&latitude=32.50629186322736&location=%E6%B1%9F%E8%8B%8F%E7%9C%81%E6%B3%B0%E5%B7%9E%E5%B8%82%E5%A7%9C%E5%A0%B0%E5%8C%BA%E5%8D%97%E4%BA%AC%E8%B7%AF5%E9%9D%A0%E8%BF%91%E6%B1%9F%E8%8B%8F%E5%A4%AA%E5%B9%B3%E6%B4%8B%E7%B2%BE%E9%94%BB%E7%A7%91%E6%8A%80%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E4%B8%80%E5%8E%82%E5%8C%BA&appid=3&logintoken=9f1284b48e24cc0bb203cc9fa06bc378&platform=android&appname=MJ&version=3.2.0.092817&serialno=JLB29R2ZNL&kernel_version=3.3.6.1&miudriveserver=&miudrive=3.2.0.092817&car_model=&machine_brand=&car_version=&car_mac=A0:2C:1A:52:B8:15&imei=352345441628693&resolution=800x960&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=FEEB7946556F7C5A508822D52355FDCE HTTP/1.1" 200 3224 "-"
      case "/MobileInternet/Music/menuRecList" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/Radio/collect_radio?album_id=295157&id=11611174&category=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B3&duration=954&title=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B302%E4%BC%9A%E9%9D%A2+&img=http%3A%2F%2Fpic.qingting.fm%2Fchannel%2F2019%2F04%2F18%2F29595f987878b52b8274af058d3a7758.jpg%21200&userid=2684768&radio=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B302%E4%BC%9A%E9%9D%A2+&type=0&city=%E4%B9%9D%E6%B1%9F%E5%B8%82&province=%E6%B1%9F%E8%A5%BF%E7%9C%81&area=%E6%B5%94%E9%98%B3%E5%8C%BA&longitude=116.0135267469618&latitude=29.730203721788193&location=%E6%B1%9F%E8%A5%BF%E7%9C%81%E4%B9%9D%E6%B1%9F%E5%B8%82%E6%B5%94%E9%98%B3%E5%8C%BA%E8%8A%B1%E6%9E%9C%E5%9B%AD%E5%8C%97%E8%B7%AF%E9%9D%A0%E8%BF%91%E6%9C%9D%E9%98%B3%E9%87%8C&appid=3&logintoken=8ce4706cbd3336e42e6bf98300d9a6a9&platform=android&appname=MJ&version=3.0.2.072418&serialno=8bf70c041e06489&kernel_version=&miudriveserver=2.0.7&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=00:08:22:B1:D1:FB&imei=8bf70c041e06489&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=CEF7177D3BF581D0CF51D8A4DFE0C28A
      case "/MobileInternet/Radio/collect_radio" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/Radio/collectRadio_list?page=1&userid=0&city=%E4%BF%9D%E5%AE%9A%E5%B8%82&province=%E6%B2%B3%E5%8C%97%E7%9C%81&area=%E6%B8%85%E8%8B%91%E5%8C%BA&longitude=115.56979871961805&latitude=38.795680067274304&location=%E6%B2%B3%E5%8C%97%E7%9C%81%E4%BF%9D%E5%AE%9A%E5%B8%82%E6%B8%85%E8%8B%91%E5%8C%BA%E9%9D%A0%E8%BF%91%E8%82%A9%E9%A2%88%E4%B8%80%E7%BB%9D&appid=3&logintoken=&platform=android&appname=MJSP&version=1.0.1.061311&serialno=LVDYAULNZHVG9H4T&kernel_version=1.0.2.1&miudriveserver=&miudrive=1.0.1.061311&car_model=&machine_brand=&car_version=&car_mac=00:08:22:C8:AF:FB&imei&resolution=1024x600&company=&network=4g&car_brand=&car_models=&car_detail=&didisign=2220596EE07EC3503401DEC865241CE5 HTTP/1.1" 200 76 "-"
      case "/MobileInternet/Radio/collectRadio_list" => "上报位置："+getParm.getParamByUrl(url,"location")
      //GET /MobileInternet/Radio/is_collect?userid=1951208&channel_id=3808960&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=8f4f2c19a862bb24ad981e0f1e9f4f7e&platform=android&appname=MJ&version=3.0.2.072418&serialno=4450503705240c08038f&kernel_version=2.24.2.1&miudriveserver=2.0.9&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:F3:03:3C&imei=867864085265212&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=D9CBA5F9F93039D6CAB03E60D5EF8F7D HTTP/1.1" 200 90 "-"
      case "/MobileInternet/Radio/is_collect" => "上报位置："+getParm.getParamByUrl(url,"location")

      //case "/MobileInternet/Service/canLink" => "导入激活sn"
      //"GET /MobileInternet/service/checkCode?code=88ZI9NXDXH1Y&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=&platform=android&appname=MJPRO&version=1.0.1.052514&userid=&serialno=88ZI9NXDXH1Y&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.052514&car_model=&machine_brand=&car_version=&car_mac=6C:21:A2:71:9D:C2&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=nissan%00&sn=88ZI9NXDXH1Y&blackList=true&didisign=B17C463991AF9A4D42FC633E86D05057 HTTP/1.1" 200 963 "-" "Mozilla/5.0
      case "//MobileInternet/service/checkCode"|"/MobileInternet/service/checkCode"|"""/MobileInternet/service/checkCode\""" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/service/getCode?device_name=%E5%96%B5%E9%A9%BE%E7%9B%92%E5%AD%90&device_id=f07392b3-a869-4d19-a4f8-93ac51c63641&firmware_version=MIUOS1.0_008_121_2019040216&code=12AKEW426MEW&mac=CC%3A4B%3A73%3A7A%3A76%3AF2&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=&platform=android&appname=MJPRO&version=1.0.1.040214&userid=&serialno=12AKEW426MEW&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.040214&car_model=&machine_brand=&car_version=&car_mac=CC:4B:73:7A:76:F2&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=volkswagen%00&sn=12AKEW426MEW&didisign=A44D7AD7124BCFD23B208435D4A7EC09 HTTP/1.1"
      case "/MobileInternet/service/getCode" => "上报位置："+getParm.getParamByUrl(url,"location")

      //case "/MobileInternet/service/getIcon" => "获取图标或内容"

      //case "/MobileInternet/user/delCollectRecord" => parms(0).split("\\=")(1)+" "+"删除收藏记录"+parms(1).split("\\=")(1)
      //"GET /MobileInternet/user/getPreset?userid=3508386&city=%E9%93%B6%E5%B7%9D%E5%B8%82&province=%E5%AE%81%E5%A4%8F%E5%9B%9E%E6%97%8F%E8%87%AA%E6%B2%BB%E5%8C%BA&area=%E6%B0%B8%E5%AE%81%E5%8E%BF&longitude=106.273811&latitude=38.380916&location=%E5%AE%81%E5%A4%8F%E5%9B%9E%E6%97%8F%E8%87%AA%E6%B2%BB%E5%8C%BA%E9%93%B6%E5%B7%9D%E5%B8%82%E6%B0%B8%E5%AE%81%E5%8E%BF%E6%9C%9B%E9%80%9A%E8%B7%AF2&appid=3&logintoken=e0b914f9e46ccb7aa2c9ad3f1db30b5c&platform=android&appname=MJ&version=3.0.0.070317&serialno=644078928404442006d1&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.0.0.070317&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:AF:37:2A&imei=867862936240426&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=4D5B4920C71A2A43DF026DC87D732B
      case "/MobileInternet/user/getPreset" => "上报位置："+getParm.getParamByUrl(url,"location")
      //"GET /MobileInternet/user/getSearchList?appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&imei=24BA9D39-C4CB-4D0E-A35D-FA6C9BC62136&logintoken=d4373831b9c626f8a54e1f42c3f56509&page=1&platform=ios&userid=3508537&version=1.0.1.0 HTTP/1.1" 200 83 "-" "
      case "/MobileInternet/user/getSearchList" => "上报位置："+getParm.getParamByUrl(url,"city")
      //"GET /MobileInternet/user/getUsers?userid=1916922&city=%E5%B2%B3%E9%98%B3%E5%B8%82&province=%E6%B9%96%E5%8D%97%E7%9C%81&area=%E5%B2%B3%E9%98%B3%E6%A5%BC%E5%8C%BA&longitude=113.16867377387153&latitude=29.395735948350694&location=%E6%B9%96%E5%8D%97%E7%9C%81%E5%B2%B3%E9%98%B3%E5%B8%82%E5%B2%B3%E9%98%B3%E6%A5%BC%E5%8C%BA%E5%86%B7%E6%B0%B4%E9%93%BA%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%86%B7%E6%B0%B4%E9%93%BA%E8%A1%97%E9%81%93%E7%BA%A2%E6%97%A5%E7%A4%BE%E5%8C%BA%E5%8D%AB%E7%94%9F%E6%9C%8D%E5%8A%A1%E7%AB%99&appid=3&logintoken=156040caa5373e4fab314db52b4595d2&platform=android&appname=MJSP&version=1.0.0.050817&serialno=0123456789ABCDEF&kernel_version=1.0.2.1&miudriveserver=&miudrive=1.0.0.050817&car_model=&machine_brand=&car_version=&car_mac=00:08:22:06:AE:FB&imei&resolution=1024x600&company=&network=4g&car_brand=&car_models=&car_detail=&didisign=1FBAC0E65C229A6B0BF7929529735CF4
      case "/MobileInternet/user/getUsers" => "上报位置："+getParm.getParamByUrl(url,"location")

      //case "/MobileInternet/user/putCollectRecord" => "添加导航收藏"
      //"GET /MobileInternet/user/putSearchRecord?addr=%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%95%AA%E7%A6%BA%E5%8C%BA%E7%9F%B3%E5%9F%BA%E9%95%87S5%E5%B9%BF%E6%98%8E%E9%AB%98%E9%80%9F&appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&detail=%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%95%AA%E7%A6%BA%E5%8C%BA%E7%9F%B3%E5%9F%BA%E9%95%87S5%E5%B9%BF%E6%98%8E%E9%AB%98%E9%80%9F&imei=8BB7C864-910B-449A-BD99-346E3BDC4945&latitude=22.995855&logintoken=46a8fdd6f5564eeb7792fb94aa648ab9&longitude=113.411197&platform=ios&userid=3505503&version=1.0.1.
      case "/MobileInternet/user/putSearchRecord" => "上报位置："+getParm.getParamByUrl(url,"city")
      //"GET /MobileInternet/user/welcome?userid=3221892&city=&province=&area=&longitude=106.15597249348959&latitude=30.77332763671875&location=&appid=3&logintoken=ed20f9f1219bdb364d91b2508d398234&platform=android&appname=MJ&version=3.0.0.070317&serialno=34c078914214581401d1&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.0.0.070317&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:2E:2B:84&imei=867860778221188&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=3A203DCBC4668980B532F74EFED4F449 HTTP/1.1" 200 106 "-" "Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; t3 Build/KOT49H) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"
      case "/MobileInternet/user/welcome" => "上报位置："+getParm.getParamByUrl(url,"location")

        case "/MobileInternet/Voice/order_json"  => "无法获取位置信息"
    }

  }

  /**
    * 根据接口名对应出相应的行动操作
    * @param url
    * @return
    */
  def parse_action(url:String):String = {
    val interfacetype: String = url.split("\\?")(0)
    interfacetype match {
        case "/MobileInternet/index/mileageUpload"|"""/MobileInternet/index/mileageUpload\""" => "里程数上报"
        case "/MobileInternet/index/uploadLocus"|"""/MobileInternet/index/uploadLocus\""" => "上报轨迹"
      //"GET /MobileInternet/index/uploadData?activate=1&appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E6%B7%B1%E5%9C%B3%E5%B8%82&code=&id=0&imei=45CCDA79-2EFC-4F66-A821-D8FA74DE7A91&kernel_version=&latitude=22.56091959635417&logintoken=dea0fffa93b45168df95788ec0e6235f&longitude=114.0987581380208&mac=020000000000&miudrive=1.0.0.0&miudriveserve=&mobile_version=10.3&model=iPhone%206S%20Plus&number=&platform=IOS&serialno=3004ADD6C3F944AF&userid=2965034&version=1.0.1.0 HTTP/1.1" 200 156 "-" "MDriving/1.0.10829 (iPhone; iOS 10.3.3; Scale/3.00)"
      case "/MobileInternet/index/uploadData" => "连接上报"
      //"GET /MobileInternet/index/version?appname=MJGJ&sev=3.24.1.1&version=3.2.1.111319&userid=3182536&city=%E5%93%88%E5%B0%94%E6%BB%A8%E5%B8%82&province=%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81&area=%E6%9D%BE%E5%8C%97%E5%8C%BA&longitude=126.59065483940972&latitude=45.80972900390625&location=%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81%E5%93%88%E5%B0%94%E6%BB%A8%E5%B8%82%E6%9D%BE%E5%8C%97%E5%8C%BA%E9%9D%A0%E8%BF%91%E8%83%A1%E5%AE%B6%E8%A1%97&appid=1&logintoken=a475f4bbd7e63bf5b453b69600099d5b&platform=android&mobile_model=JSN-AL00&mobile_version=9&imei=863845041313317&mobile_mac=30%3A45%3A96%3A45%3A2F%3A81&resolution=1080x2255&company=%E4%B8%AD%E5%9B%BD%E7%94%B5%E4%BF%A1&network=4G&didisign=90675249135E6F4C0F40F869C30F8870 HTTP/1.1" 200 82 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/index/version" => "固件升级"
      //"GET /MobileInternet/Creategroup/check?userid=3512495&appid=1&logintoken=75730df9be222b232e8ef7958d4a5d44&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&platform=ios&appname=MJ&version=3.1.0.042610&didisign=5AFD4C0A9673BDB00702601F0319F824 HTTP/1.1" 200 130 "-" "okhttp/3.3.0"
      case "/MobileInternet/Creategroup/check" => "位置共享"
      //"GET /MobileInternet/Creategroup/create?userid=2593902&city=%E6%BC%B3%E5%B7%9E%E5%B8%82&appid=1&logintoken=69307cc41238a3ae363484986b87a867&city=%E6%BC%B3%E5%B7%9E%E5%B8%82&platform=android&appname=MJ&version=3.1.0.042811&didisign=1AF3E843BA7CBBE0123C286B07D963DA HTTP/1.1" 200 144 "-" "okhttp/3.3.0"
      case "/MobileInternet/Creategroup/create" => "位置共享"
      //"GET /MobileInternet/Creategroup/join?userid=3510329&key=2580&city=%E4%B8%B4%E6%B2%82%E5%B8%82&province=%E5%B1%B1%E4%B8%9C%E7%9C%81&area=%E8%8E%92%E5%8D%97%E5%8E%BF&longitude=119.09035&latitude=35.224427&location=%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%B4%E6%B2%82%E5%B8%82%E8%8E%92%E5%8D%97%E5%8E%BF%E5%A4%A7%E5%B1%B1%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%B1%B1%E4%B8%9C%E4%B8%B4%E6%B8%AF%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&appid=1&logintoken=8a5538e0b29909ea90f460a2a7c97d35&platform=android&appname=MJ&version=3.1.0.042811&mobile_model=MI%208&mobile_version=9&imei=863976042770195&mobile_mac=94%3A87%3AE0%3A0C%3A98%3A91&resolution=1080x2029&company=%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8&network=4G&didisign=A842B726D3E60AAA8DEE1362B069A0C7 HTTP/1.1" 200 94 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/Creategroup/join/"|"/MobileInternet/Creategroup/join" => "位置共享"
      //"GET /MobileInternet/Creategroup/signout?group_id=38856&userid=3510329&city=%E4%B8%B4%E6%B2%82%E5%B8%82&province=%E5%B1%B1%E4%B8%9C%E7%9C%81&area=%E8%8E%92%E5%8D%97%E5%8E%BF&longitude=119.09035&latitude=35.224427&location=%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%B4%E6%B2%82%E5%B8%82%E8%8E%92%E5%8D%97%E5%8E%BF%E5%A4%A7%E5%B1%B1%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%B1%B1%E4%B8%9C%E4%B8%B4%E6%B8%AF%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&appid=1&logintoken=8a5538e0b29909ea90f460a2a7c97d35&platform=android&appname=MJ&version=3.1.0.042811&mobile_model=MI%208&mobile_version=9&imei=863976042770195&mobile_mac=94%3A87%3AE0%3A0C%3A98%3A91&resolution=1080x2029&company=%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8&network=4G&didisign=2AC6FDB9754FD5EDF47D4D863F902FDA HTTP/1.1" 200 100 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/Creategroup/signout/"|"/MobileInternet/Creategroup/signout" => "位置共享"
      //"GET /MobileInternet/index/getBanner/?callback=jQuery211047555249363816987_1558830202691&tid=32&userid=3493896&logintoken=c03bdf57d020605f93523612719e343b&appname=&appid=1&platform=web&version=1.0&apptype=1&logintoken_ddshop=&wxappid=&_=1558830202692 HTTP/1.1" 200 1499 "https://api22.didi365.com/web/miudrive/mall/index.html?new=1&userid=3493896&nickname=%E5%96%B5%E5%8F%8B3493896&logintoken=c03bdf57d020605f93523612719e343b&mobile=3493896&time=1558830201460" "Mozilla/5.0 (Linux; Android 8.1.0; V1813A Build/O11019; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 MQQBrowser/6.2 TBS/044704 Mobile Safari/537.36mj/mj"
      case "//MobileInternet/index/getBanner"|"/MobileInternet/index/getBanner"|"/MobileInternet/index/getBanner/" => "广告位图片列表"
      //"GET /MobileInternet/index/msxiaoice?type=1&userid=2081939&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=6293ea18e54e247be022765e94bb8c49&platform=android&appname=MJ&version=3.0.0.25&serialno=VKUKOBTCLVLZVWON&kernel_version=3.0.4.1&miudriveserver=&miudrive=3.0.0.25&car_model=&machine_brand=&car_version=&car_mac=00:08:22:3A:15:FC&imei=865651034118970&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=DD6CE90839D3705DE279662C9441208E HTTP/1.1" 200 181 "-" "Mozilla/5.0 (Linux; U; Android 6.0; zh-cn; evb3561sv_w_65_m0 Build/MRA58K) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Mobile Safari/537.36"
      case "/MobileInternet/index/msxiaoice" => "微软小冰"
      //"GET /MobileInternet/index/sn?id=78380&second=0&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=c4d2712c61e0b043814e40c66470a78c&platform=android&appname=MJPRO&version=1.0.0.122700&userid=3376384&serialno=00GPSNMRO1TN&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.0.122700&car_model=&machine_brand=&car_version=&car_mac=E0:3B:C6:BA:96:27&imei&resolution=1024x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name&sn=00GPSNMRO1TN&didisign=374A6DF4439DF6153C6723F3C96BA120 HTTP/1.1" 200 83 "-" "Mozilla/5.0 (Linux; U; Android 7.0; zh-cn; molly Build/NRD91N) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"
      case "/MobileInternet/index/sn" => "设备序列号信息上报"
      //"GET /MobileInternet/Music/collectionList?type=1&userid=2607877&page=0&city=%E4%B8%B9%E4%B8%9C%E5%B8%82&province=%E8%BE%BD%E5%AE%81%E7%9C%81&area=%E6%8C%AF%E5%AE%89%E5%8C%BA&longitude=124.31465277777778&latitude=40.12568033854166&location=%E8%BE%BD%E5%AE%81%E7%9C%81%E4%B8%B9%E4%B8%9C%E5%B8%82%E6%8C%AF%E5%AE%89%E5%8C%BA%E5%85%B4%E5%9B%AD%E8%A1%97%E9%9D%A0%E8%BF%91%E9%9E%A0%E5%AE%B6%E5%A0%A1&appid=3&logintoken=95ff76ac87e595c4f82ec8730b3645e2&platform=android&appname=MJ&version=3.2.1.111319&serialno=344078868600041b0611&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.2.1.111319&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:1A:41:7F&imei=867860442767487&resolution=1024x600&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=03341A9F5F216036E577BE3F6F6711D6 HTTP/1.1" 200 83 "-" "Mozilla/5.0
      case "/MobileInternet/Music/collectionList" => "收藏列表"
      //"GET /MobileInternet/Music/doMusicCollect?track_artist=%E6%B8%A9%E5%B2%9A&track_id=95742&track_file_path=http%3A%2F%2Fdl.stream.qqmusic.qq.com%2FC400003oF0Pc0ahSx4.m4a%3Fvkey%3DA412336F6737A73F1F866CA8CFC0A6B9947D35B739CC4C6CEC2A1580B3769DE121BD36FFD14596B6CE5ACC2DF7522F61BDC25189B18BCD6D%26guid%3D7982961828%26uin%3D0%26fromtag%3D66&track_name=%E5%B1%8B%E9%A1%B6&userid=3408427&city=%E5%90%88%E8%82%A5%E5%B8%82&province=%E5%AE%89%E5%BE%BD%E7%9C%81&area=%E9%95%BF%E4%B8%B0%E5%8E%BF&longitude=117.142841796875&latitude=32.12981553819444&location=%E5%AE%89%E5%BE%BD%E7%9C%81%E5%90%88%E8%82%A5%E5%B8%82%E9%95%BF%E4%B8%B0%E5%8E%BF%E9%9D%A0%E8%BF%91%E9%99%B6%E6%A5%BC%E5%B0%8F%E5%AD%A6&appid=3&logintoken=ad2353db2dbfb202dbe1607d355056ac&platform=android&appname=MJ&version=3.0.2.072418&serialno=0123456789ABCDEF&kernel_version=3.34.1.1&miudriveserver=&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=C0:81:35:11:23:B6&imei&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=4F6C8FF3A246911ABBA4208FF87F7769
      case "/MobileInternet/Music/doMusicCollect" => "收藏或取消收藏"
      //"GET /MobileInternet/Music/menuMusicList?userid=3509180&id=541&page=0&city=%E8%8B%8F%E5%B7%9E%E5%B8%82&province=%E6%B1%9F%E8%8B%8F%E7%9C%81&area=%E6%98%86%E5%B1%B1%E5%B8%82&longitude=120.92695258246528&latitude=31.36940673828125&location=%E6%B1%9F%E8%8B%8F%E7%9C%81%E8%8B%8F%E5%B7%9E%E5%B8%82%E6%98%86%E5%B1%B1%E5%B8%82%E6%9C%9D%E9%98%B3%E8%A5%BF%E8%B7%AF2168%E9%9D%A0%E8%BF%91%E5%A4%A7%E8%99%9E%E6%B2%B3%E5%8D%97%E6%A1%A5&appid=3&logintoken=9fa7d447e5322b933149c579c45e60f3&platform=android&appname=MJ&version=3.2.1.111319&serialno=1440788701201c0f0851&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.2.1.111319&car_model=&machine_brand=&car_version=&car_mac=02:00:00:00:00:02&imei=867860434473589&resolution=1024x600&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=80C28A0A0E25EB885E7970ECEB3DCE5E HTTP/1.1" 200 33286
      case "/MobileInternet/Music/menuMusicList" => "车友歌单:音乐列表"
      //"GET /MobileInternet/Music/menuRecList?userid=3507148&page=1&city=%E6%B3%B0%E5%B7%9E%E5%B8%82&province=%E6%B1%9F%E8%8B%8F%E7%9C%81&area=%E5%A7%9C%E5%A0%B0%E5%8C%BA&longitude=120.11857077351644&latitude=32.50629186322736&location=%E6%B1%9F%E8%8B%8F%E7%9C%81%E6%B3%B0%E5%B7%9E%E5%B8%82%E5%A7%9C%E5%A0%B0%E5%8C%BA%E5%8D%97%E4%BA%AC%E8%B7%AF5%E9%9D%A0%E8%BF%91%E6%B1%9F%E8%8B%8F%E5%A4%AA%E5%B9%B3%E6%B4%8B%E7%B2%BE%E9%94%BB%E7%A7%91%E6%8A%80%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E4%B8%80%E5%8E%82%E5%8C%BA&appid=3&logintoken=9f1284b48e24cc0bb203cc9fa06bc378&platform=android&appname=MJ&version=3.2.0.092817&serialno=JLB29R2ZNL&kernel_version=3.3.6.1&miudriveserver=&miudrive=3.2.0.092817&car_model=&machine_brand=&car_version=&car_mac=A0:2C:1A:52:B8:15&imei=352345441628693&resolution=800x960&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=FEEB7946556F7C5A508822D52355FDCE HTTP/1.1" 200 3224 "-"
      case "/MobileInternet/Music/menuRecList" => "歌单列表"
      //"GET /MobileInternet/Radio/collect_radio?album_id=295157&id=11611174&category=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B3&duration=954&title=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B302%E4%BC%9A%E9%9D%A2+&img=http%3A%2F%2Fpic.qingting.fm%2Fchannel%2F2019%2F04%2F18%2F29595f987878b52b8274af058d3a7758.jpg%21200&userid=2684768&radio=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B302%E4%BC%9A%E9%9D%A2+&type=0&city=%E4%B9%9D%E6%B1%9F%E5%B8%82&province=%E6%B1%9F%E8%A5%BF%E7%9C%81&area=%E6%B5%94%E9%98%B3%E5%8C%BA&longitude=116.0135267469618&latitude=29.730203721788193&location=%E6%B1%9F%E8%A5%BF%E7%9C%81%E4%B9%9D%E6%B1%9F%E5%B8%82%E6%B5%94%E9%98%B3%E5%8C%BA%E8%8A%B1%E6%9E%9C%E5%9B%AD%E5%8C%97%E8%B7%AF%E9%9D%A0%E8%BF%91%E6%9C%9D%E9%98%B3%E9%87%8C&appid=3&logintoken=8ce4706cbd3336e42e6bf98300d9a6a9&platform=android&appname=MJ&version=3.0.2.072418&serialno=8bf70c041e06489&kernel_version=&miudriveserver=2.0.7&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=00:08:22:B1:D1:FB&imei=8bf70c041e06489&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=CEF7177D3BF581D0CF51D8A4DFE0C28A
      case "/MobileInternet/Radio/collect_radio" => "收藏电台"
      //"GET /MobileInternet/Radio/collectRadio_list?page=1&userid=0&city=%E4%BF%9D%E5%AE%9A%E5%B8%82&province=%E6%B2%B3%E5%8C%97%E7%9C%81&area=%E6%B8%85%E8%8B%91%E5%8C%BA&longitude=115.56979871961805&latitude=38.795680067274304&location=%E6%B2%B3%E5%8C%97%E7%9C%81%E4%BF%9D%E5%AE%9A%E5%B8%82%E6%B8%85%E8%8B%91%E5%8C%BA%E9%9D%A0%E8%BF%91%E8%82%A9%E9%A2%88%E4%B8%80%E7%BB%9D&appid=3&logintoken=&platform=android&appname=MJSP&version=1.0.1.061311&serialno=LVDYAULNZHVG9H4T&kernel_version=1.0.2.1&miudriveserver=&miudrive=1.0.1.061311&car_model=&machine_brand=&car_version=&car_mac=00:08:22:C8:AF:FB&imei&resolution=1024x600&company=&network=4g&car_brand=&car_models=&car_detail=&didisign=2220596EE07EC3503401DEC865241CE5 HTTP/1.1" 200 76 "-"
      case "/MobileInternet/Radio/collectRadio_list" => "查看电台热门分类"
      //GET /MobileInternet/Radio/is_collect?userid=1951208&channel_id=3808960&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=8f4f2c19a862bb24ad981e0f1e9f4f7e&platform=android&appname=MJ&version=3.0.2.072418&serialno=4450503705240c08038f&kernel_version=2.24.2.1&miudriveserver=2.0.9&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:F3:03:3C&imei=867864085265212&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=D9CBA5F9F93039D6CAB03E60D5EF8F7D HTTP/1.1" 200 90 "-"
      case "/MobileInternet/Radio/is_collect" => "查看是否收藏电台"

      //case "/MobileInternet/Service/canLink" => "导入激活sn"
      //"GET /MobileInternet/service/checkCode?code=88ZI9NXDXH1Y&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=&platform=android&appname=MJPRO&version=1.0.1.052514&userid=&serialno=88ZI9NXDXH1Y&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.052514&car_model=&machine_brand=&car_version=&car_mac=6C:21:A2:71:9D:C2&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=nissan%00&sn=88ZI9NXDXH1Y&blackList=true&didisign=B17C463991AF9A4D42FC633E86D05057 HTTP/1.1" 200 963 "-" "Mozilla/5.0
      case "//MobileInternet/service/checkCode"|"/MobileInternet/service/checkCode"|"""/MobileInternet/service/checkCode\""" => /*parms(12).split("\\=")(1)+" "+"上报城市："+parms(1).split("\\=")(1)+" "+*/"根据SN检测激活状态"
      //"GET /MobileInternet/service/getCode?device_name=%E5%96%B5%E9%A9%BE%E7%9B%92%E5%AD%90&device_id=f07392b3-a869-4d19-a4f8-93ac51c63641&firmware_version=MIUOS1.0_008_121_2019040216&code=12AKEW426MEW&mac=CC%3A4B%3A73%3A7A%3A76%3AF2&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=&platform=android&appname=MJPRO&version=1.0.1.040214&userid=&serialno=12AKEW426MEW&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.040214&car_model=&machine_brand=&car_version=&car_mac=CC:4B:73:7A:76:F2&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=volkswagen%00&sn=12AKEW426MEW&didisign=A44D7AD7124BCFD23B208435D4A7EC09 HTTP/1.1"
      case "/MobileInternet/service/getCode" => "根据SN获取二维码"

      //case "/MobileInternet/service/getIcon" => "获取图标或内容"

      //case "/MobileInternet/user/delCollectRecord" => "删除收藏记录"
      //"GET /MobileInternet/user/getPreset?userid=3508386&city=%E9%93%B6%E5%B7%9D%E5%B8%82&province=%E5%AE%81%E5%A4%8F%E5%9B%9E%E6%97%8F%E8%87%AA%E6%B2%BB%E5%8C%BA&area=%E6%B0%B8%E5%AE%81%E5%8E%BF&longitude=106.273811&latitude=38.380916&location=%E5%AE%81%E5%A4%8F%E5%9B%9E%E6%97%8F%E8%87%AA%E6%B2%BB%E5%8C%BA%E9%93%B6%E5%B7%9D%E5%B8%82%E6%B0%B8%E5%AE%81%E5%8E%BF%E6%9C%9B%E9%80%9A%E8%B7%AF2&appid=3&logintoken=e0b914f9e46ccb7aa2c9ad3f1db30b5c&platform=android&appname=MJ&version=3.0.0.070317&serialno=644078928404442006d1&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.0.0.070317&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:AF:37:2A&imei=867862936240426&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=4D5B4920C71A2A43DF026DC87D732B
      case "/MobileInternet/user/getPreset" => "获取预设地址"
      //"GET /MobileInternet/user/getSearchList?appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&imei=24BA9D39-C4CB-4D0E-A35D-FA6C9BC62136&logintoken=d4373831b9c626f8a54e1f42c3f56509&page=1&platform=ios&userid=3508537&version=1.0.1.0 HTTP/1.1" 200 83 "-" "
      case "/MobileInternet/user/getSearchList" => "导航搜索列表"
      //"GET /MobileInternet/user/getUsers?userid=1916922&city=%E5%B2%B3%E9%98%B3%E5%B8%82&province=%E6%B9%96%E5%8D%97%E7%9C%81&area=%E5%B2%B3%E9%98%B3%E6%A5%BC%E5%8C%BA&longitude=113.16867377387153&latitude=29.395735948350694&location=%E6%B9%96%E5%8D%97%E7%9C%81%E5%B2%B3%E9%98%B3%E5%B8%82%E5%B2%B3%E9%98%B3%E6%A5%BC%E5%8C%BA%E5%86%B7%E6%B0%B4%E9%93%BA%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%86%B7%E6%B0%B4%E9%93%BA%E8%A1%97%E9%81%93%E7%BA%A2%E6%97%A5%E7%A4%BE%E5%8C%BA%E5%8D%AB%E7%94%9F%E6%9C%8D%E5%8A%A1%E7%AB%99&appid=3&logintoken=156040caa5373e4fab314db52b4595d2&platform=android&appname=MJSP&version=1.0.0.050817&serialno=0123456789ABCDEF&kernel_version=1.0.2.1&miudriveserver=&miudrive=1.0.0.050817&car_model=&machine_brand=&car_version=&car_mac=00:08:22:06:AE:FB&imei&resolution=1024x600&company=&network=4g&car_brand=&car_models=&car_detail=&didisign=1FBAC0E65C229A6B0BF7929529735CF4
      case "/MobileInternet/user/getUsers" => "导航-用户地址"

      case "/MobileInternet/user/putCollectRecord" => "添加导航收藏"
      //"GET /MobileInternet/user/putSearchRecord?addr=%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%95%AA%E7%A6%BA%E5%8C%BA%E7%9F%B3%E5%9F%BA%E9%95%87S5%E5%B9%BF%E6%98%8E%E9%AB%98%E9%80%9F&appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&detail=%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%95%AA%E7%A6%BA%E5%8C%BA%E7%9F%B3%E5%9F%BA%E9%95%87S5%E5%B9%BF%E6%98%8E%E9%AB%98%E9%80%9F&imei=8BB7C864-910B-449A-BD99-346E3BDC4945&latitude=22.995855&logintoken=46a8fdd6f5564eeb7792fb94aa648ab9&longitude=113.411197&platform=ios&userid=3505503&version=1.0.1.
      case "/MobileInternet/user/putSearchRecord" => "添加导航搜索记录"
      //"GET /MobileInternet/user/welcome?userid=3221892&city=&province=&area=&longitude=106.15597249348959&latitude=30.77332763671875&location=&appid=3&logintoken=ed20f9f1219bdb364d91b2508d398234&platform=android&appname=MJ&version=3.0.0.070317&serialno=34c078914214581401d1&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.0.0.070317&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:2E:2B:84&imei=867860778221188&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=3A203DCBC4668980B532F74EFED4F449 HTTP/1.1" 200 106 "-" "Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; t3 Build/KOT49H) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"
      case "/MobileInternet/user/welcome" => "开机"
      //"GET /MobileInternet/Voice/order_json?city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=c4832a36b8e3636ab2061aa3414c0ca9&platform=android&appname=MJPRO&version=1.0.1.043022&userid=3500940&serialno=32MQNFWZLQNF&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.043022&car_model=&machine_brand=&car_version=&car_mac=6C:21:A2:71:B0:74&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=volkswagen%00&sn=32MQNFWZLQNF&blackList=true&didisign=98A09AFD851680C65BF554F1FB1183C6 HTTP/1.1"
        case "/MobileInternet/Voice/order_json"  => "上传文件"
    }
  }

  /**
    * 根据接口名对应出相应的行动操作
    * @param url
    * @return
    */
  def parse_act(url:String):String = {
    val interfacetype: String = url.split("\\?")(0)
    interfacetype match {
      case "/MobileInternet/index/mileageUpload"|"""/MobileInternet/index/mileageUpload\""" => "mileageUpload"
      case "/MobileInternet/index/uploadLocus"|"""/MobileInternet/index/uploadLocus\""" => "uploadLocus"
      //"GET /MobileInternet/index/uploadData?activate=1&appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E6%B7%B1%E5%9C%B3%E5%B8%82&code=&id=0&imei=45CCDA79-2EFC-4F66-A821-D8FA74DE7A91&kernel_version=&latitude=22.56091959635417&logintoken=dea0fffa93b45168df95788ec0e6235f&longitude=114.0987581380208&mac=020000000000&miudrive=1.0.0.0&miudriveserve=&mobile_version=10.3&model=iPhone%206S%20Plus&number=&platform=IOS&serialno=3004ADD6C3F944AF&userid=2965034&version=1.0.1.0 HTTP/1.1" 200 156 "-" "MDriving/1.0.10829 (iPhone; iOS 10.3.3; Scale/3.00)"
      case "/MobileInternet/index/uploadData" => "uploadData"
      //"GET /MobileInternet/index/version?appname=MJGJ&sev=3.24.1.1&version=3.2.1.111319&userid=3182536&city=%E5%93%88%E5%B0%94%E6%BB%A8%E5%B8%82&province=%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81&area=%E6%9D%BE%E5%8C%97%E5%8C%BA&longitude=126.59065483940972&latitude=45.80972900390625&location=%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81%E5%93%88%E5%B0%94%E6%BB%A8%E5%B8%82%E6%9D%BE%E5%8C%97%E5%8C%BA%E9%9D%A0%E8%BF%91%E8%83%A1%E5%AE%B6%E8%A1%97&appid=1&logintoken=a475f4bbd7e63bf5b453b69600099d5b&platform=android&mobile_model=JSN-AL00&mobile_version=9&imei=863845041313317&mobile_mac=30%3A45%3A96%3A45%3A2F%3A81&resolution=1080x2255&company=%E4%B8%AD%E5%9B%BD%E7%94%B5%E4%BF%A1&network=4G&didisign=90675249135E6F4C0F40F869C30F8870 HTTP/1.1" 200 82 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/index/version" => "version"
      //"GET /MobileInternet/Creategroup/check?userid=3512495&appid=1&logintoken=75730df9be222b232e8ef7958d4a5d44&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&platform=ios&appname=MJ&version=3.1.0.042610&didisign=5AFD4C0A9673BDB00702601F0319F824 HTTP/1.1" 200 130 "-" "okhttp/3.3.0"
      case "/MobileInternet/Creategroup/check" => "check"
      //"GET /MobileInternet/Creategroup/create?userid=2593902&city=%E6%BC%B3%E5%B7%9E%E5%B8%82&appid=1&logintoken=69307cc41238a3ae363484986b87a867&city=%E6%BC%B3%E5%B7%9E%E5%B8%82&platform=android&appname=MJ&version=3.1.0.042811&didisign=1AF3E843BA7CBBE0123C286B07D963DA HTTP/1.1" 200 144 "-" "okhttp/3.3.0"
      case "/MobileInternet/Creategroup/create" => "create"
      //"GET /MobileInternet/Creategroup/join?userid=3510329&key=2580&city=%E4%B8%B4%E6%B2%82%E5%B8%82&province=%E5%B1%B1%E4%B8%9C%E7%9C%81&area=%E8%8E%92%E5%8D%97%E5%8E%BF&longitude=119.09035&latitude=35.224427&location=%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%B4%E6%B2%82%E5%B8%82%E8%8E%92%E5%8D%97%E5%8E%BF%E5%A4%A7%E5%B1%B1%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%B1%B1%E4%B8%9C%E4%B8%B4%E6%B8%AF%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&appid=1&logintoken=8a5538e0b29909ea90f460a2a7c97d35&platform=android&appname=MJ&version=3.1.0.042811&mobile_model=MI%208&mobile_version=9&imei=863976042770195&mobile_mac=94%3A87%3AE0%3A0C%3A98%3A91&resolution=1080x2029&company=%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8&network=4G&didisign=A842B726D3E60AAA8DEE1362B069A0C7 HTTP/1.1" 200 94 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/Creategroup/join/"|"/MobileInternet/Creategroup/join" => "join"
      //"GET /MobileInternet/Creategroup/signout?group_id=38856&userid=3510329&city=%E4%B8%B4%E6%B2%82%E5%B8%82&province=%E5%B1%B1%E4%B8%9C%E7%9C%81&area=%E8%8E%92%E5%8D%97%E5%8E%BF&longitude=119.09035&latitude=35.224427&location=%E5%B1%B1%E4%B8%9C%E7%9C%81%E4%B8%B4%E6%B2%82%E5%B8%82%E8%8E%92%E5%8D%97%E5%8E%BF%E5%A4%A7%E5%B1%B1%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%B1%B1%E4%B8%9C%E4%B8%B4%E6%B8%AF%E6%9C%89%E8%89%B2%E9%87%91%E5%B1%9E%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&appid=1&logintoken=8a5538e0b29909ea90f460a2a7c97d35&platform=android&appname=MJ&version=3.1.0.042811&mobile_model=MI%208&mobile_version=9&imei=863976042770195&mobile_mac=94%3A87%3AE0%3A0C%3A98%3A91&resolution=1080x2029&company=%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8&network=4G&didisign=2AC6FDB9754FD5EDF47D4D863F902FDA HTTP/1.1" 200 100 "-" "okhttp-okgo/jeasonlzy"
      case "/MobileInternet/Creategroup/signout/"|"/MobileInternet/Creategroup/signout" => "signout"
      //"GET /MobileInternet/index/getBanner/?callback=jQuery211047555249363816987_1558830202691&tid=32&userid=3493896&logintoken=c03bdf57d020605f93523612719e343b&appname=&appid=1&platform=web&version=1.0&apptype=1&logintoken_ddshop=&wxappid=&_=1558830202692 HTTP/1.1" 200 1499 "https://api22.didi365.com/web/miudrive/mall/index.html?new=1&userid=3493896&nickname=%E5%96%B5%E5%8F%8B3493896&logintoken=c03bdf57d020605f93523612719e343b&mobile=3493896&time=1558830201460" "Mozilla/5.0 (Linux; Android 8.1.0; V1813A Build/O11019; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.126 MQQBrowser/6.2 TBS/044704 Mobile Safari/537.36mj/mj"
      case "//MobileInternet/index/getBanner"|"/MobileInternet/index/getBanner"|"/MobileInternet/index/getBanner/" => "getBanner"
      //"GET /MobileInternet/index/msxiaoice?type=1&userid=2081939&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=6293ea18e54e247be022765e94bb8c49&platform=android&appname=MJ&version=3.0.0.25&serialno=VKUKOBTCLVLZVWON&kernel_version=3.0.4.1&miudriveserver=&miudrive=3.0.0.25&car_model=&machine_brand=&car_version=&car_mac=00:08:22:3A:15:FC&imei=865651034118970&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=DD6CE90839D3705DE279662C9441208E HTTP/1.1" 200 181 "-" "Mozilla/5.0 (Linux; U; Android 6.0; zh-cn; evb3561sv_w_65_m0 Build/MRA58K) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Mobile Safari/537.36"
      case "/MobileInternet/index/msxiaoice" => "msxiaoice"
      //"GET /MobileInternet/index/sn?id=78380&second=0&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=c4d2712c61e0b043814e40c66470a78c&platform=android&appname=MJPRO&version=1.0.0.122700&userid=3376384&serialno=00GPSNMRO1TN&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.0.122700&car_model=&machine_brand=&car_version=&car_mac=E0:3B:C6:BA:96:27&imei&resolution=1024x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name&sn=00GPSNMRO1TN&didisign=374A6DF4439DF6153C6723F3C96BA120 HTTP/1.1" 200 83 "-" "Mozilla/5.0 (Linux; U; Android 7.0; zh-cn; molly Build/NRD91N) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"
      case "/MobileInternet/index/sn" => "sn"
      //"GET /MobileInternet/Music/collectionList?type=1&userid=2607877&page=0&city=%E4%B8%B9%E4%B8%9C%E5%B8%82&province=%E8%BE%BD%E5%AE%81%E7%9C%81&area=%E6%8C%AF%E5%AE%89%E5%8C%BA&longitude=124.31465277777778&latitude=40.12568033854166&location=%E8%BE%BD%E5%AE%81%E7%9C%81%E4%B8%B9%E4%B8%9C%E5%B8%82%E6%8C%AF%E5%AE%89%E5%8C%BA%E5%85%B4%E5%9B%AD%E8%A1%97%E9%9D%A0%E8%BF%91%E9%9E%A0%E5%AE%B6%E5%A0%A1&appid=3&logintoken=95ff76ac87e595c4f82ec8730b3645e2&platform=android&appname=MJ&version=3.2.1.111319&serialno=344078868600041b0611&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.2.1.111319&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:1A:41:7F&imei=867860442767487&resolution=1024x600&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=03341A9F5F216036E577BE3F6F6711D6 HTTP/1.1" 200 83 "-" "Mozilla/5.0
      case "/MobileInternet/Music/collectionList" => "collectionList"
      //"GET /MobileInternet/Music/doMusicCollect?track_artist=%E6%B8%A9%E5%B2%9A&track_id=95742&track_file_path=http%3A%2F%2Fdl.stream.qqmusic.qq.com%2FC400003oF0Pc0ahSx4.m4a%3Fvkey%3DA412336F6737A73F1F866CA8CFC0A6B9947D35B739CC4C6CEC2A1580B3769DE121BD36FFD14596B6CE5ACC2DF7522F61BDC25189B18BCD6D%26guid%3D7982961828%26uin%3D0%26fromtag%3D66&track_name=%E5%B1%8B%E9%A1%B6&userid=3408427&city=%E5%90%88%E8%82%A5%E5%B8%82&province=%E5%AE%89%E5%BE%BD%E7%9C%81&area=%E9%95%BF%E4%B8%B0%E5%8E%BF&longitude=117.142841796875&latitude=32.12981553819444&location=%E5%AE%89%E5%BE%BD%E7%9C%81%E5%90%88%E8%82%A5%E5%B8%82%E9%95%BF%E4%B8%B0%E5%8E%BF%E9%9D%A0%E8%BF%91%E9%99%B6%E6%A5%BC%E5%B0%8F%E5%AD%A6&appid=3&logintoken=ad2353db2dbfb202dbe1607d355056ac&platform=android&appname=MJ&version=3.0.2.072418&serialno=0123456789ABCDEF&kernel_version=3.34.1.1&miudriveserver=&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=C0:81:35:11:23:B6&imei&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=4F6C8FF3A246911ABBA4208FF87F7769
      case "/MobileInternet/Music/doMusicCollect" => "doMusicCollect"
      //"GET /MobileInternet/Music/menuMusicList?userid=3509180&id=541&page=0&city=%E8%8B%8F%E5%B7%9E%E5%B8%82&province=%E6%B1%9F%E8%8B%8F%E7%9C%81&area=%E6%98%86%E5%B1%B1%E5%B8%82&longitude=120.92695258246528&latitude=31.36940673828125&location=%E6%B1%9F%E8%8B%8F%E7%9C%81%E8%8B%8F%E5%B7%9E%E5%B8%82%E6%98%86%E5%B1%B1%E5%B8%82%E6%9C%9D%E9%98%B3%E8%A5%BF%E8%B7%AF2168%E9%9D%A0%E8%BF%91%E5%A4%A7%E8%99%9E%E6%B2%B3%E5%8D%97%E6%A1%A5&appid=3&logintoken=9fa7d447e5322b933149c579c45e60f3&platform=android&appname=MJ&version=3.2.1.111319&serialno=1440788701201c0f0851&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.2.1.111319&car_model=&machine_brand=&car_version=&car_mac=02:00:00:00:00:02&imei=867860434473589&resolution=1024x600&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=80C28A0A0E25EB885E7970ECEB3DCE5E HTTP/1.1" 200 33286
      case "/MobileInternet/Music/menuMusicList" => "menuMusicList"
      //"GET /MobileInternet/Music/menuRecList?userid=3507148&page=1&city=%E6%B3%B0%E5%B7%9E%E5%B8%82&province=%E6%B1%9F%E8%8B%8F%E7%9C%81&area=%E5%A7%9C%E5%A0%B0%E5%8C%BA&longitude=120.11857077351644&latitude=32.50629186322736&location=%E6%B1%9F%E8%8B%8F%E7%9C%81%E6%B3%B0%E5%B7%9E%E5%B8%82%E5%A7%9C%E5%A0%B0%E5%8C%BA%E5%8D%97%E4%BA%AC%E8%B7%AF5%E9%9D%A0%E8%BF%91%E6%B1%9F%E8%8B%8F%E5%A4%AA%E5%B9%B3%E6%B4%8B%E7%B2%BE%E9%94%BB%E7%A7%91%E6%8A%80%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E4%B8%80%E5%8E%82%E5%8C%BA&appid=3&logintoken=9f1284b48e24cc0bb203cc9fa06bc378&platform=android&appname=MJ&version=3.2.0.092817&serialno=JLB29R2ZNL&kernel_version=3.3.6.1&miudriveserver=&miudrive=3.2.0.092817&car_model=&machine_brand=&car_version=&car_mac=A0:2C:1A:52:B8:15&imei=352345441628693&resolution=800x960&company=&network=wifi&car_brand=&car_models=&car_detail=&didisign=FEEB7946556F7C5A508822D52355FDCE HTTP/1.1" 200 3224 "-"
      case "/MobileInternet/Music/menuRecList" => "menuRecList"
      //"GET /MobileInternet/Radio/collect_radio?album_id=295157&id=11611174&category=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B3&duration=954&title=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B302%E4%BC%9A%E9%9D%A2+&img=http%3A%2F%2Fpic.qingting.fm%2Fchannel%2F2019%2F04%2F18%2F29595f987878b52b8274af058d3a7758.jpg%21200&userid=2684768&radio=%E4%BA%A1%E4%BA%BA%E7%9B%B8%E6%9C%AF%EF%BC%9A%E6%9A%97%E7%9E%B302%E4%BC%9A%E9%9D%A2+&type=0&city=%E4%B9%9D%E6%B1%9F%E5%B8%82&province=%E6%B1%9F%E8%A5%BF%E7%9C%81&area=%E6%B5%94%E9%98%B3%E5%8C%BA&longitude=116.0135267469618&latitude=29.730203721788193&location=%E6%B1%9F%E8%A5%BF%E7%9C%81%E4%B9%9D%E6%B1%9F%E5%B8%82%E6%B5%94%E9%98%B3%E5%8C%BA%E8%8A%B1%E6%9E%9C%E5%9B%AD%E5%8C%97%E8%B7%AF%E9%9D%A0%E8%BF%91%E6%9C%9D%E9%98%B3%E9%87%8C&appid=3&logintoken=8ce4706cbd3336e42e6bf98300d9a6a9&platform=android&appname=MJ&version=3.0.2.072418&serialno=8bf70c041e06489&kernel_version=&miudriveserver=2.0.7&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=00:08:22:B1:D1:FB&imei=8bf70c041e06489&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=CEF7177D3BF581D0CF51D8A4DFE0C28A
      case "/MobileInternet/Radio/collect_radio" => "collect_radio"
      //"GET /MobileInternet/Radio/collectRadio_list?page=1&userid=0&city=%E4%BF%9D%E5%AE%9A%E5%B8%82&province=%E6%B2%B3%E5%8C%97%E7%9C%81&area=%E6%B8%85%E8%8B%91%E5%8C%BA&longitude=115.56979871961805&latitude=38.795680067274304&location=%E6%B2%B3%E5%8C%97%E7%9C%81%E4%BF%9D%E5%AE%9A%E5%B8%82%E6%B8%85%E8%8B%91%E5%8C%BA%E9%9D%A0%E8%BF%91%E8%82%A9%E9%A2%88%E4%B8%80%E7%BB%9D&appid=3&logintoken=&platform=android&appname=MJSP&version=1.0.1.061311&serialno=LVDYAULNZHVG9H4T&kernel_version=1.0.2.1&miudriveserver=&miudrive=1.0.1.061311&car_model=&machine_brand=&car_version=&car_mac=00:08:22:C8:AF:FB&imei&resolution=1024x600&company=&network=4g&car_brand=&car_models=&car_detail=&didisign=2220596EE07EC3503401DEC865241CE5 HTTP/1.1" 200 76 "-"
      case "/MobileInternet/Radio/collectRadio_list" => "collectRadio_list"
      //GET /MobileInternet/Radio/is_collect?userid=1951208&channel_id=3808960&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=8f4f2c19a862bb24ad981e0f1e9f4f7e&platform=android&appname=MJ&version=3.0.2.072418&serialno=4450503705240c08038f&kernel_version=2.24.2.1&miudriveserver=2.0.9&miudrive=3.0.2.072418&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:F3:03:3C&imei=867864085265212&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=D9CBA5F9F93039D6CAB03E60D5EF8F7D HTTP/1.1" 200 90 "-"
      case "/MobileInternet/Radio/is_collect" => "is_collect"

      //case "/MobileInternet/Service/canLink" => "导入激活sn"
      //"GET /MobileInternet/service/checkCode?code=88ZI9NXDXH1Y&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=&platform=android&appname=MJPRO&version=1.0.1.052514&userid=&serialno=88ZI9NXDXH1Y&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.052514&car_model=&machine_brand=&car_version=&car_mac=6C:21:A2:71:9D:C2&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=nissan%00&sn=88ZI9NXDXH1Y&blackList=true&didisign=B17C463991AF9A4D42FC633E86D05057 HTTP/1.1" 200 963 "-" "Mozilla/5.0
      case "//MobileInternet/service/checkCode"|"/MobileInternet/service/checkCode"|"""/MobileInternet/service/checkCode\""" => "checkCode"
      //"GET /MobileInternet/service/getCode?device_name=%E5%96%B5%E9%A9%BE%E7%9B%92%E5%AD%90&device_id=f07392b3-a869-4d19-a4f8-93ac51c63641&firmware_version=MIUOS1.0_008_121_2019040216&code=12AKEW426MEW&mac=CC%3A4B%3A73%3A7A%3A76%3AF2&city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=&platform=android&appname=MJPRO&version=1.0.1.040214&userid=&serialno=12AKEW426MEW&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.040214&car_model=&machine_brand=&car_version=&car_mac=CC:4B:73:7A:76:F2&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=volkswagen%00&sn=12AKEW426MEW&didisign=A44D7AD7124BCFD23B208435D4A7EC09 HTTP/1.1"
      case "/MobileInternet/service/getCode" => "getCode"

      //case "/MobileInternet/service/getIcon" => "获取图标或内容"

      //case "/MobileInternet/user/delCollectRecord" => "删除收藏记录"
      //"GET /MobileInternet/user/getPreset?userid=3508386&city=%E9%93%B6%E5%B7%9D%E5%B8%82&province=%E5%AE%81%E5%A4%8F%E5%9B%9E%E6%97%8F%E8%87%AA%E6%B2%BB%E5%8C%BA&area=%E6%B0%B8%E5%AE%81%E5%8E%BF&longitude=106.273811&latitude=38.380916&location=%E5%AE%81%E5%A4%8F%E5%9B%9E%E6%97%8F%E8%87%AA%E6%B2%BB%E5%8C%BA%E9%93%B6%E5%B7%9D%E5%B8%82%E6%B0%B8%E5%AE%81%E5%8E%BF%E6%9C%9B%E9%80%9A%E8%B7%AF2&appid=3&logintoken=e0b914f9e46ccb7aa2c9ad3f1db30b5c&platform=android&appname=MJ&version=3.0.0.070317&serialno=644078928404442006d1&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.0.0.070317&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:AF:37:2A&imei=867862936240426&resolution=1024x600&company=&network=android_usb&car_brand=&car_models=&car_detail=&didisign=4D5B4920C71A2A43DF026DC87D732B
      case "/MobileInternet/user/getPreset" => "getPreset"
      //"GET /MobileInternet/user/getSearchList?appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&imei=24BA9D39-C4CB-4D0E-A35D-FA6C9BC62136&logintoken=d4373831b9c626f8a54e1f42c3f56509&page=1&platform=ios&userid=3508537&version=1.0.1.0 HTTP/1.1" 200 83 "-" "
      case "/MobileInternet/user/getSearchList" => "getSearchList"
      //"GET /MobileInternet/user/getUsers?userid=1916922&city=%E5%B2%B3%E9%98%B3%E5%B8%82&province=%E6%B9%96%E5%8D%97%E7%9C%81&area=%E5%B2%B3%E9%98%B3%E6%A5%BC%E5%8C%BA&longitude=113.16867377387153&latitude=29.395735948350694&location=%E6%B9%96%E5%8D%97%E7%9C%81%E5%B2%B3%E9%98%B3%E5%B8%82%E5%B2%B3%E9%98%B3%E6%A5%BC%E5%8C%BA%E5%86%B7%E6%B0%B4%E9%93%BA%E8%B7%AF%E9%9D%A0%E8%BF%91%E5%86%B7%E6%B0%B4%E9%93%BA%E8%A1%97%E9%81%93%E7%BA%A2%E6%97%A5%E7%A4%BE%E5%8C%BA%E5%8D%AB%E7%94%9F%E6%9C%8D%E5%8A%A1%E7%AB%99&appid=3&logintoken=156040caa5373e4fab314db52b4595d2&platform=android&appname=MJSP&version=1.0.0.050817&serialno=0123456789ABCDEF&kernel_version=1.0.2.1&miudriveserver=&miudrive=1.0.0.050817&car_model=&machine_brand=&car_version=&car_mac=00:08:22:06:AE:FB&imei&resolution=1024x600&company=&network=4g&car_brand=&car_models=&car_detail=&didisign=1FBAC0E65C229A6B0BF7929529735CF4
      case "/MobileInternet/user/getUsers" => "getUsers"

      case "/MobileInternet/user/putCollectRecord" => "putCollectRecord"
      //"GET /MobileInternet/user/putSearchRecord?addr=%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%95%AA%E7%A6%BA%E5%8C%BA%E7%9F%B3%E5%9F%BA%E9%95%87S5%E5%B9%BF%E6%98%8E%E9%AB%98%E9%80%9F&appid=1&appname=SAIC&apptype=1&car_appname=SAICGJ&city=%E5%B9%BF%E5%B7%9E%E5%B8%82&detail=%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%95%AA%E7%A6%BA%E5%8C%BA%E7%9F%B3%E5%9F%BA%E9%95%87S5%E5%B9%BF%E6%98%8E%E9%AB%98%E9%80%9F&imei=8BB7C864-910B-449A-BD99-346E3BDC4945&latitude=22.995855&logintoken=46a8fdd6f5564eeb7792fb94aa648ab9&longitude=113.411197&platform=ios&userid=3505503&version=1.0.1.
      case "/MobileInternet/user/putSearchRecord" => "putSearchRecord"
      //"GET /MobileInternet/user/welcome?userid=3221892&city=&province=&area=&longitude=106.15597249348959&latitude=30.77332763671875&location=&appid=3&logintoken=ed20f9f1219bdb364d91b2508d398234&platform=android&appname=MJ&version=3.0.0.070317&serialno=34c078914214581401d1&kernel_version=3.24.1.1&miudriveserver=2.0.9&miudrive=3.0.0.070317&car_model=&machine_brand=&car_version=&car_mac=DC:44:6D:2E:2B:84&imei=867860778221188&resolution=1024x600&company=&network=ios_usb&car_brand=&car_models=&car_detail=&didisign=3A203DCBC4668980B532F74EFED4F449 HTTP/1.1" 200 106 "-" "Mozilla/5.0 (Linux; U; Android 4.4.2; zh-cn; t3 Build/KOT49H) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"
      case "/MobileInternet/user/welcome" => "welcome"
      //"GET /MobileInternet/Voice/order_json?city=&province=&area=&longitude=&latitude=&location=&appid=3&logintoken=c4832a36b8e3636ab2061aa3414c0ca9&platform=android&appname=MJPRO&version=1.0.1.043022&userid=3500940&serialno=32MQNFWZLQNF&kernel_version=1.49.1.1&miudriveserver=&miudrive=1.0.1.043022&car_model=&machine_brand=&car_version=&car_mac=6C:21:A2:71:B0:74&imei&resolution=800x480&company=&network=4g&car_brand=&car_models=&car_detail=&car_name=volkswagen%00&sn=32MQNFWZLQNF&blackList=true&didisign=98A09AFD851680C65BF554F1FB1183C6 HTTP/1.1"
      case "/MobileInternet/Voice/order_json"  => "order_json"
    }
  }


  def main(args: Array[String]): Unit = {
      val conf: SparkConf = new SparkConf().setAppName("LogAnalyze").setMaster("local[*]")
      val sc: SparkContext = SparkContext.getOrCreate(conf)
      val spark: SparkSession = SparkSession.builder().config(conf).enableHiveSupport().getOrCreate()
      import spark.implicits._
      val logDF: DataFrame = spark.sql("select * from didi_log_ods.nginx_orc_ods")
      println(logDF.count())

      val dateFormat = new DateFormat
      val utils = new HiveUtils
      val logDS:Dataset[KPI1] =logDF.as[KPI].map{ line =>
      val str: String = line.time.replace("[","").replace("]","")
      val text: Text = dateFormat.evaluate(new Text(str))
      val method: String = line.request.split(" ")(0).replace("\"","")
      val a_request: String = utils.evaluate(line.request.split(" ")(1).replace("\"",""))
      val a_time: String = text.toString
      KPI1(line.ipaddress,a_time,method,a_request,line.status,line.size,line.referer,line.agent)
    }.filter(_.method=="GET")
    //logDS.map(line =>utils.evaluate(line.request)).map(line =>parse_parm(line)).write.saveAsTable("default.aa")


    println(logDS.count())

    val  log_interfaceDS = logDS.map{line =>
       val format = new InterfaceFormat
        val interface_type: String = format.interface_format(line.request.toString.split("\\?")(0))
        val user_id = getParm.getParamByUrl(line.request,"userid")
        val action = parse_action(line.request)
        val act = parse_act(line.request)
        val info = parse_info(line.request)
        val location = parse_location(line.request)
        val longitude = getParm.getParamByUrl(line.request,"longitude")
        val latitude = getParm.getParamByUrl(line.request,"latitude")
      LogDtail(line.ipaddress,line.time,line.method,interface_type,line.request,line.status,line.size,line.referer,line.agent,user_id,action,act,info,location,longitude,latitude)
    }
    log_interfaceDS.write.saveAsTable("default.aa")

    println(log_interfaceDS.count())
  sc.stop()
  spark.stop()
  }
}


case class KPI(
                ipaddress:String,
                identity:String,
                user:String,
                time:String,
                request:String,
                status:String,
                size:String,
                referer:String,
                agent:String
              ) extends Serializable
case class KPI1(
                ipaddress:String,
                time:String,
                method:String,
                request:String,
                status:String,
                size:String,
                referer:String,
                agent:String
              ) extends Serializable
/*case class KPI2(
                 ipaddress:String,
                 time:String,
                 method:String,
                 interface_type:String,
                 parm:String,
                 status:String,
                 size:String,
                 referer:String,
                 agent:String
               ) extends Serializable*/
case class LogDtail(
                     ipaddress:String,
                     time:String,
                     method:String,
                     interface_type:String,
                     parm:String,
                     status:String,
                     size:String,
                     referer:String,
                     agent:String,
                     user_id:String,
                     action:String,
                     act:String,
                     detail:String,
                     location:String,
                     longitude:String,
                     latitude:String
                   ) extends Serializable